---
import { Button } from "./ui/button"
---

<header
  class="fixed w-full top-0 left-0 h-14 bg-background/60 backdrop-blur-sm"
>
  <div class="flex items-center px-4 h-full w-full justify-end">
    <Button id="toggle-theme" type="button" size="icon" variant="outline">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        ><path d="M12 8a2.83 2.83 0 0 0 4 4 4 4 0 1 1-4-4"></path><path
          d="M12 2v2"></path><path d="M12 20v2"></path><path
          d="m4.9 4.9 1.4 1.4"></path><path d="m17.7 17.7 1.4 1.4"></path><path
          d="M2 12h2"></path><path d="M20 12h2"></path><path
          d="m6.3 17.7-1.4 1.4"></path><path d="m19.1 4.9-1.4 1.4"></path></svg
      >
    </Button>
  </div>
</header>

<script is:inline>
  const toggleThemeButton = document.getElementById("toggle-theme")

  const theme = (() => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme")
    }
    if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
      return "dark"
    }
    return "light"
  })()

  if (theme === "dark") {
    document.documentElement.classList.add("dark")
  } else {
    document.documentElement.classList.remove("dark")
  }

  window.localStorage.setItem("theme", theme)

  toggleThemeButton.addEventListener("click", () => {
    const element = document.documentElement
    element.classList.toggle("dark")
    const isDark = element.classList.contains("dark")
    localStorage.setItem("theme", isDark ? "dark" : "light")
  })
</script>
